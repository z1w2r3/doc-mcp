# DocxTPL Online - åœ¨çº¿æ–‡æ¡£ç”ŸæˆæœåŠ¡å¹³å°

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

DocxTPL Online æ˜¯ä¸€ä¸ªåŸºäºç°æœ‰ docxtpl-mcp é¡¹ç›®æ‰©å±•çš„åœ¨çº¿ SaaS å¹³å°ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡ Web ç•Œé¢ç®¡ç†æ¨¡æ¿ã€ç”Ÿæˆæ–‡æ¡£ï¼Œå¹¶æ”¯æŒæ¨¡æ¿å…±äº«å’Œäº¤æ˜“ã€‚

### æ ¸å¿ƒç‰¹æ€§
- ğŸŒ **å¤šç§Ÿæˆ·æ¶æ„** - æ”¯æŒå¤šç”¨æˆ·éš”ç¦»å’Œæƒé™ç®¡ç†
- ğŸ“ **æ¨¡æ¿ç®¡ç†** - åœ¨çº¿ä¸Šä¼ ã€ç¼–è¾‘ã€ç‰ˆæœ¬æ§åˆ¶
- ğŸš€ **API è®¿é—®** - RESTful API å’Œ GraphQL æ”¯æŒ
- ğŸ¤ **æ¨¡æ¿å¸‚åœº** - å…¬å…±æ¨¡æ¿å…±äº«å’Œäº¤æ˜“
- ğŸ”’ **å®‰å…¨è®¤è¯** - JWT + OAuth2.0 æ”¯æŒ
- ğŸ“Š **æ•°æ®åˆ†æ** - ä½¿ç”¨ç»Ÿè®¡å’ŒæŠ¥è¡¨
- ğŸ’° **è®¡è´¹ç³»ç»Ÿ** - ä½¿ç”¨é‡è®¡è´¹å’Œè®¢é˜…åˆ¶
- ğŸ”Œ **MCP å…¼å®¹** - ä¿æŒä¸åŸ MCP åè®®å…¼å®¹

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         å‰ç«¯åº”ç”¨å±‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Web UI  â”‚  â”‚Mobile Appâ”‚  â”‚  API Docs â”‚  â”‚ Admin UI â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ HTTPS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API ç½‘å…³å±‚ (Nginx)                      â”‚
â”‚            è´Ÿè½½å‡è¡¡ â”‚ é™æµ â”‚ ç¼“å­˜ â”‚ SSLç»ˆç«¯                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      åº”ç”¨æœåŠ¡å±‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚              FastAPI Application                    â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚     â”‚
â”‚  â”‚  â”‚   Auth   â”‚  â”‚ Template â”‚  â”‚ Document â”‚        â”‚     â”‚
â”‚  â”‚  â”‚  Service â”‚  â”‚  Service â”‚  â”‚ Generatorâ”‚        â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚     â”‚
â”‚  â”‚  â”‚  Market  â”‚  â”‚  Billing â”‚  â”‚Analytics â”‚        â”‚     â”‚
â”‚  â”‚  â”‚  Service â”‚  â”‚  Service â”‚  â”‚  Service â”‚        â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚            MCP Bridge Service                       â”‚     â”‚
â”‚  â”‚         (ä¿æŒä¸MCPå®¢æˆ·ç«¯å…¼å®¹)                        â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•°æ®å±‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚PostgreSQLâ”‚  â”‚  Redis   â”‚  â”‚   S3/    â”‚  â”‚  Elastic â”‚   â”‚
â”‚  â”‚(ä¸»æ•°æ®åº“) â”‚  â”‚  (ç¼“å­˜)  â”‚  â”‚  MinIO   â”‚  â”‚  Search  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ä»»åŠ¡é˜Ÿåˆ—å±‚                               â”‚
â”‚              Celery + RabbitMQ/Redis                         â”‚
â”‚         å¼‚æ­¥ä»»åŠ¡ â”‚ å®šæ—¶ä»»åŠ¡ â”‚ æ‰¹é‡å¤„ç†                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ’» æŠ€æœ¯æ ˆè¯¦ç»†è¯´æ˜

### åç«¯æŠ€æœ¯æ ˆ

#### æ ¸å¿ƒæ¡†æ¶
- **FastAPI** (v0.100+) - é«˜æ€§èƒ½å¼‚æ­¥ Web æ¡†æ¶
- **SQLAlchemy** (v2.0+) - ORM å’Œæ•°æ®åº“å·¥å…·
- **Pydantic** (v2.0+) - æ•°æ®éªŒè¯å’Œåºåˆ—åŒ–
- **Alembic** - æ•°æ®åº“è¿ç§»ç®¡ç†

#### è®¤è¯ä¸å®‰å…¨
- **python-jose[cryptography]** - JWT token ç”Ÿæˆå’ŒéªŒè¯
- **passlib[bcrypt]** - å¯†ç å“ˆå¸Œ
- **python-multipart** - æ–‡ä»¶ä¸Šä¼ å¤„ç†
- **authlib** - OAuth2.0 å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨

#### ä»»åŠ¡é˜Ÿåˆ—
- **Celery** (v5.3+) - åˆ†å¸ƒå¼ä»»åŠ¡é˜Ÿåˆ—
- **celery-beat** - å®šæ—¶ä»»åŠ¡è°ƒåº¦
- **flower** - Celery ç›‘æ§å·¥å…·

#### æ–‡æ¡£å¤„ç†
- **docxtpl** - Word æ¨¡æ¿å¤„ç†ï¼ˆæ ¸å¿ƒï¼‰
- **python-docx** - Word æ–‡æ¡£æ“ä½œ
- **Jinja2** - æ¨¡æ¿å¼•æ“
- **Pillow** - å›¾ç‰‡å¤„ç†

#### å­˜å‚¨å’Œç¼“å­˜
- **boto3** - AWS S3 å®¢æˆ·ç«¯
- **minio** - MinIO å®¢æˆ·ç«¯ï¼ˆS3 å…¼å®¹ï¼‰
- **redis-py** - Redis å®¢æˆ·ç«¯
- **asyncpg** - PostgreSQL å¼‚æ­¥é©±åŠ¨

#### API æ–‡æ¡£å’Œæµ‹è¯•
- **pytest** - æµ‹è¯•æ¡†æ¶
- **pytest-asyncio** - å¼‚æ­¥æµ‹è¯•æ”¯æŒ
- **httpx** - HTTP å®¢æˆ·ç«¯æµ‹è¯•
- **faker** - æµ‹è¯•æ•°æ®ç”Ÿæˆ

### å‰ç«¯æŠ€æœ¯æ ˆ

#### æ ¸å¿ƒæ¡†æ¶
- **React** (v18+) æˆ– **Vue 3** - UI æ¡†æ¶
- **TypeScript** (v5+) - ç±»å‹å®‰å…¨
- **Vite** - æ„å»ºå·¥å…·
- **React Router** / **Vue Router** - è·¯ç”±ç®¡ç†

#### çŠ¶æ€ç®¡ç†
- **Redux Toolkit** (React) æˆ– **Pinia** (Vue)
- **React Query** / **Vue Query** - æœåŠ¡ç«¯çŠ¶æ€ç®¡ç†

#### UI ç»„ä»¶åº“
- **Ant Design** (v5+) æˆ– **Element Plus**
- **TailwindCSS** - å®ç”¨ä¼˜å…ˆçš„ CSS æ¡†æ¶
- **Monaco Editor** - ä»£ç ç¼–è¾‘å™¨ç»„ä»¶

#### å·¥å…·åº“
- **axios** - HTTP å®¢æˆ·ç«¯
- **dayjs** - æ—¥æœŸå¤„ç†
- **react-hook-form** / **vee-validate** - è¡¨å•éªŒè¯
- **recharts** / **echarts** - å›¾è¡¨åº“

### åŸºç¡€è®¾æ–½

#### å®¹å™¨åŒ–
- **Docker** - å®¹å™¨åŒ–
- **Docker Compose** - æœ¬åœ°å¼€å‘ç¯å¢ƒ
- **Kubernetes** - ç”Ÿäº§ç¯å¢ƒç¼–æ’

#### æ•°æ®åº“
- **PostgreSQL 15+** - ä¸»æ•°æ®åº“
- **Redis 7+** - ç¼“å­˜å’Œä¼šè¯å­˜å‚¨
- **Elasticsearch 8+** - å…¨æ–‡æœç´¢

#### æ¶ˆæ¯é˜Ÿåˆ—
- **RabbitMQ** æˆ– **Redis** - æ¶ˆæ¯ä»£ç†

#### ç›‘æ§å’Œæ—¥å¿—
- **Prometheus** - æŒ‡æ ‡æ”¶é›†
- **Grafana** - å¯è§†åŒ–ç›‘æ§
- **ELK Stack** - æ—¥å¿—ç®¡ç†
- **Sentry** - é”™è¯¯è¿½è¸ª

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
docxtpl-online/
â”œâ”€â”€ backend/                    # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ main.py           # FastAPI åº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ core/             # æ ¸å¿ƒé…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ config.py     # é…ç½®ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ security.py   # å®‰å…¨ç›¸å…³
â”‚   â”‚   â”‚   â””â”€â”€ database.py   # æ•°æ®åº“è¿æ¥
â”‚   â”‚   â”œâ”€â”€ api/              # API è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ v1/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ auth.py   # è®¤è¯æ¥å£
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ templates.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ documents.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ market.py
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ users.py
â”‚   â”‚   â”‚   â””â”€â”€ v2/           # API ç‰ˆæœ¬2
â”‚   â”‚   â”œâ”€â”€ models/           # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ user.py
â”‚   â”‚   â”‚   â”œâ”€â”€ template.py
â”‚   â”‚   â”‚   â”œâ”€â”€ document.py
â”‚   â”‚   â”‚   â””â”€â”€ billing.py
â”‚   â”‚   â”œâ”€â”€ schemas/          # Pydantic æ¨¡å¼
â”‚   â”‚   â”‚   â”œâ”€â”€ user.py
â”‚   â”‚   â”‚   â”œâ”€â”€ template.py
â”‚   â”‚   â”‚   â””â”€â”€ document.py
â”‚   â”‚   â”œâ”€â”€ services/         # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ auth_service.py
â”‚   â”‚   â”‚   â”œâ”€â”€ template_service.py
â”‚   â”‚   â”‚   â”œâ”€â”€ document_service.py
â”‚   â”‚   â”‚   â”œâ”€â”€ storage_service.py
â”‚   â”‚   â”‚   â””â”€â”€ billing_service.py
â”‚   â”‚   â”œâ”€â”€ workers/          # Celery ä»»åŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ celery_app.py
â”‚   â”‚   â”‚   â”œâ”€â”€ document_tasks.py
â”‚   â”‚   â”‚   â””â”€â”€ email_tasks.py
â”‚   â”‚   â”œâ”€â”€ mcp_bridge/       # MCP åè®®æ¡¥æ¥
â”‚   â”‚   â”‚   â”œâ”€â”€ server.py
â”‚   â”‚   â”‚   â””â”€â”€ handlers.py
â”‚   â”‚   â””â”€â”€ utils/            # å·¥å…·å‡½æ•°
â”‚   â”‚       â”œâ”€â”€ docx_processor.py
â”‚   â”‚       â”œâ”€â”€ validators.py
â”‚   â”‚       â””â”€â”€ helpers.py
â”‚   â”œâ”€â”€ migrations/            # Alembic è¿ç§»
â”‚   â”‚   â””â”€â”€ versions/
â”‚   â”œâ”€â”€ tests/                # æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ unit/
â”‚   â”‚   â”œâ”€â”€ integration/
â”‚   â”‚   â””â”€â”€ e2e/
â”‚   â”œâ”€â”€ requirements.txt      # Python ä¾èµ–
â”‚   â”œâ”€â”€ .env.example          # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”‚   â””â”€â”€ Dockerfile            # Docker é•œåƒ
â”‚
â”œâ”€â”€ frontend/                  # å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ assets/           # é™æ€èµ„æº
â”‚   â”‚   â”œâ”€â”€ components/       # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Layout/
â”‚   â”‚   â”‚   â”œâ”€â”€ Forms/
â”‚   â”‚   â”‚   â””â”€â”€ Charts/
â”‚   â”‚   â”œâ”€â”€ pages/           # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Home/
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard/
â”‚   â”‚   â”‚   â”œâ”€â”€ Templates/
â”‚   â”‚   â”‚   â”œâ”€â”€ Documents/
â”‚   â”‚   â”‚   â”œâ”€â”€ Market/
â”‚   â”‚   â”‚   â””â”€â”€ Settings/
â”‚   â”‚   â”œâ”€â”€ services/        # API æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ api.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â”‚   â””â”€â”€ templates.ts
â”‚   â”‚   â”œâ”€â”€ store/           # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â”‚   â””â”€â”€ templates.ts
â”‚   â”‚   â”œâ”€â”€ hooks/           # è‡ªå®šä¹‰ Hooks
â”‚   â”‚   â”œâ”€â”€ utils/           # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ types/           # TypeScript ç±»å‹
â”‚   â”‚   â”œâ”€â”€ App.tsx          # åº”ç”¨å…¥å£
â”‚   â”‚   â””â”€â”€ main.tsx         # ä¸»å…¥å£
â”‚   â”œâ”€â”€ public/              # å…¬å…±æ–‡ä»¶
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â””â”€â”€ Dockerfile
â”‚
â”œâ”€â”€ docker/                   # Docker é…ç½®
â”‚   â”œâ”€â”€ docker-compose.yml   # å¼€å‘ç¯å¢ƒ
â”‚   â”œâ”€â”€ docker-compose.prod.yml
â”‚   â””â”€â”€ nginx/
â”‚       â””â”€â”€ nginx.conf
â”‚
â”œâ”€â”€ kubernetes/              # K8s éƒ¨ç½²é…ç½®
â”‚   â”œâ”€â”€ namespace.yaml
â”‚   â”œâ”€â”€ configmap.yaml
â”‚   â”œâ”€â”€ secret.yaml
â”‚   â”œâ”€â”€ deployment.yaml
â”‚   â”œâ”€â”€ service.yaml
â”‚   â””â”€â”€ ingress.yaml
â”‚
â”œâ”€â”€ scripts/                 # éƒ¨ç½²å’Œç»´æŠ¤è„šæœ¬
â”‚   â”œâ”€â”€ deploy.sh
â”‚   â”œâ”€â”€ backup.sh
â”‚   â””â”€â”€ migrate.sh
â”‚
â”œâ”€â”€ docs/                    # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ API.md
â”‚   â”œâ”€â”€ DEPLOYMENT.md
â”‚   â”œâ”€â”€ DEVELOPMENT.md
â”‚   â””â”€â”€ USER_GUIDE.md
â”‚
â”œâ”€â”€ .github/                 # GitHub Actions
â”‚   â””â”€â”€ workflows/
â”‚       â”œâ”€â”€ ci.yml
â”‚       â””â”€â”€ cd.yml
â”‚
â”œâ”€â”€ .gitignore
â”œâ”€â”€ LICENSE
â””â”€â”€ README.md
```

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒæ•°æ®è¡¨

```sql
-- ç”¨æˆ·è¡¨
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    username VARCHAR(100) UNIQUE NOT NULL,
    hashed_password VARCHAR(255) NOT NULL,
    full_name VARCHAR(255),
    is_active BOOLEAN DEFAULT true,
    is_superuser BOOLEAN DEFAULT false,
    email_verified BOOLEAN DEFAULT false,
    avatar_url VARCHAR(500),
    subscription_tier VARCHAR(50) DEFAULT 'free',
    api_key VARCHAR(255) UNIQUE,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    last_login TIMESTAMP WITH TIME ZONE
);

-- æ¨¡æ¿è¡¨
CREATE TABLE templates (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    category VARCHAR(100),
    tags TEXT[],
    file_path VARCHAR(500),
    file_size INTEGER,
    thumbnail_url VARCHAR(500),
    variables JSONB,  -- å­˜å‚¨æ¨¡æ¿å˜é‡ä¿¡æ¯
    schema JSONB,     -- å­˜å‚¨å­—æ®µéªŒè¯è§„åˆ™
    is_public BOOLEAN DEFAULT false,
    is_featured BOOLEAN DEFAULT false,
    price DECIMAL(10, 2) DEFAULT 0,
    usage_count INTEGER DEFAULT 0,
    rating DECIMAL(3, 2),
    version INTEGER DEFAULT 1,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    UNIQUE(user_id, name, version)
);

-- æ¨¡æ¿ç‰ˆæœ¬è¡¨
CREATE TABLE template_versions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    template_id UUID REFERENCES templates(id) ON DELETE CASCADE,
    version_number INTEGER NOT NULL,
    file_path VARCHAR(500),
    changelog TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    created_by UUID REFERENCES users(id)
);

-- æ–‡æ¡£ç”Ÿæˆè®°å½•è¡¨
CREATE TABLE documents (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    template_id UUID REFERENCES templates(id),
    document_name VARCHAR(255),
    file_path VARCHAR(500),
    file_size INTEGER,
    input_data JSONB,
    generation_time_ms INTEGER,
    status VARCHAR(50), -- pending, processing, completed, failed
    error_message TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    expires_at TIMESTAMP WITH TIME ZONE
);

-- æ¨¡æ¿å…±äº«è¡¨
CREATE TABLE template_shares (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    template_id UUID REFERENCES templates(id) ON DELETE CASCADE,
    shared_by UUID REFERENCES users(id),
    shared_with UUID REFERENCES users(id),
    permission VARCHAR(50), -- view, use, edit
    expires_at TIMESTAMP WITH TIME ZONE,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

-- æ¨¡æ¿å¸‚åœºäº¤æ˜“è¡¨
CREATE TABLE marketplace_transactions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    template_id UUID REFERENCES templates(id),
    buyer_id UUID REFERENCES users(id),
    seller_id UUID REFERENCES users(id),
    price DECIMAL(10, 2),
    commission DECIMAL(10, 2),
    payment_method VARCHAR(50),
    transaction_id VARCHAR(255),
    status VARCHAR(50),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

-- API ä½¿ç”¨è®°å½•è¡¨
CREATE TABLE api_usage (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    endpoint VARCHAR(255),
    method VARCHAR(10),
    request_body_size INTEGER,
    response_body_size INTEGER,
    status_code INTEGER,
    response_time_ms INTEGER,
    ip_address INET,
    user_agent TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

-- ç”¨æˆ·è®¢é˜…è¡¨
CREATE TABLE subscriptions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    plan_name VARCHAR(100),
    price_monthly DECIMAL(10, 2),
    document_limit INTEGER,
    storage_limit_mb INTEGER,
    api_rate_limit INTEGER,
    features JSONB,
    status VARCHAR(50), -- active, cancelled, expired
    started_at TIMESTAMP WITH TIME ZONE,
    ends_at TIMESTAMP WITH TIME ZONE,
    cancelled_at TIMESTAMP WITH TIME ZONE,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_templates_user_id ON templates(user_id);
CREATE INDEX idx_templates_is_public ON templates(is_public);
CREATE INDEX idx_templates_category ON templates(category);
CREATE INDEX idx_documents_user_id ON documents(user_id);
CREATE INDEX idx_documents_template_id ON documents(template_id);
CREATE INDEX idx_documents_status ON documents(status);
CREATE INDEX idx_api_usage_user_id ON api_usage(user_id);
CREATE INDEX idx_api_usage_created_at ON api_usage(created_at);

-- åˆ›å»ºè§¦å‘å™¨æ›´æ–° updated_at
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = CURRENT_TIMESTAMP;
    RETURN NEW;
END;
$$ language 'plpgsql';

CREATE TRIGGER update_users_updated_at BEFORE UPDATE ON users
    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER update_templates_updated_at BEFORE UPDATE ON templates
    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();
```

## ğŸ” API è®¾è®¡

### RESTful API ç«¯ç‚¹

#### è®¤è¯ç›¸å…³
```
POST   /api/v1/auth/register        # ç”¨æˆ·æ³¨å†Œ
POST   /api/v1/auth/login           # ç”¨æˆ·ç™»å½•
POST   /api/v1/auth/refresh         # åˆ·æ–° token
POST   /api/v1/auth/logout          # ç”¨æˆ·ç™»å‡º
POST   /api/v1/auth/forgot-password # å¿˜è®°å¯†ç 
POST   /api/v1/auth/reset-password  # é‡ç½®å¯†ç 
GET    /api/v1/auth/verify-email    # é‚®ç®±éªŒè¯
```

#### ç”¨æˆ·ç®¡ç†
```
GET    /api/v1/users/me             # è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
PUT    /api/v1/users/me             # æ›´æ–°ç”¨æˆ·ä¿¡æ¯
DELETE /api/v1/users/me             # åˆ é™¤è´¦å·
GET    /api/v1/users/me/api-keys    # è·å– API å¯†é’¥
POST   /api/v1/users/me/api-keys    # ç”Ÿæˆæ–° API å¯†é’¥
DELETE /api/v1/users/me/api-keys/{key_id} # åˆ é™¤ API å¯†é’¥
```

#### æ¨¡æ¿ç®¡ç†
```
GET    /api/v1/templates            # è·å–æ¨¡æ¿åˆ—è¡¨
POST   /api/v1/templates            # åˆ›å»ºæ–°æ¨¡æ¿
GET    /api/v1/templates/{id}       # è·å–æ¨¡æ¿è¯¦æƒ…
PUT    /api/v1/templates/{id}       # æ›´æ–°æ¨¡æ¿
DELETE /api/v1/templates/{id}       # åˆ é™¤æ¨¡æ¿
POST   /api/v1/templates/{id}/duplicate # å¤åˆ¶æ¨¡æ¿
GET    /api/v1/templates/{id}/variables # è·å–æ¨¡æ¿å˜é‡
POST   /api/v1/templates/{id}/validate  # éªŒè¯æ¨¡æ¿
GET    /api/v1/templates/{id}/versions  # è·å–ç‰ˆæœ¬å†å²
POST   /api/v1/templates/{id}/share     # å…±äº«æ¨¡æ¿
```

#### æ–‡æ¡£ç”Ÿæˆ
```
POST   /api/v1/documents/generate   # ç”Ÿæˆæ–‡æ¡£
GET    /api/v1/documents            # è·å–æ–‡æ¡£åˆ—è¡¨
GET    /api/v1/documents/{id}       # è·å–æ–‡æ¡£è¯¦æƒ…
GET    /api/v1/documents/{id}/download # ä¸‹è½½æ–‡æ¡£
DELETE /api/v1/documents/{id}       # åˆ é™¤æ–‡æ¡£
POST   /api/v1/documents/batch      # æ‰¹é‡ç”Ÿæˆæ–‡æ¡£
```

#### æ¨¡æ¿å¸‚åœº
```
GET    /api/v1/marketplace          # æµè§ˆå¸‚åœºæ¨¡æ¿
GET    /api/v1/marketplace/{id}     # æ¨¡æ¿è¯¦æƒ…
POST   /api/v1/marketplace/{id}/purchase # è´­ä¹°æ¨¡æ¿
POST   /api/v1/marketplace/{id}/rate     # è¯„ä»·æ¨¡æ¿
GET    /api/v1/marketplace/categories    # è·å–åˆ†ç±»
GET    /api/v1/marketplace/trending      # çƒ­é—¨æ¨¡æ¿
```

#### ç»Ÿè®¡åˆ†æ
```
GET    /api/v1/analytics/usage      # ä½¿ç”¨ç»Ÿè®¡
GET    /api/v1/analytics/documents  # æ–‡æ¡£ç»Ÿè®¡
GET    /api/v1/analytics/api        # API ä½¿ç”¨ç»Ÿè®¡
GET    /api/v1/analytics/storage    # å­˜å‚¨ä½¿ç”¨æƒ…å†µ
```

### GraphQL API

```graphql
type Query {
  # ç”¨æˆ·ç›¸å…³
  me: User
  user(id: ID!): User

  # æ¨¡æ¿ç›¸å…³
  templates(
    filter: TemplateFilter
    pagination: PaginationInput
  ): TemplateConnection!

  template(id: ID!): Template

  # æ–‡æ¡£ç›¸å…³
  documents(
    filter: DocumentFilter
    pagination: PaginationInput
  ): DocumentConnection!

  document(id: ID!): Document

  # å¸‚åœºç›¸å…³
  marketplace(
    category: String
    search: String
    pagination: PaginationInput
  ): MarketplaceConnection!
}

type Mutation {
  # è®¤è¯
  register(input: RegisterInput!): AuthPayload!
  login(input: LoginInput!): AuthPayload!

  # æ¨¡æ¿æ“ä½œ
  createTemplate(input: CreateTemplateInput!): Template!
  updateTemplate(id: ID!, input: UpdateTemplateInput!): Template!
  deleteTemplate(id: ID!): Boolean!

  # æ–‡æ¡£ç”Ÿæˆ
  generateDocument(input: GenerateDocumentInput!): Document!

  # å¸‚åœºäº¤æ˜“
  purchaseTemplate(templateId: ID!): Transaction!
}

type Subscription {
  documentGenerated(userId: ID!): Document!
  templateUpdated(templateId: ID!): Template!
}
```

## ğŸš€ éƒ¨ç½²æ–¹æ¡ˆ

### å¼€å‘ç¯å¢ƒéƒ¨ç½²

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/yourusername/docxtpl-online.git
cd docxtpl-online

# 2. è®¾ç½®ç¯å¢ƒå˜é‡
cp backend/.env.example backend/.env
cp frontend/.env.example frontend/.env

# 3. å¯åŠ¨ Docker Compose
docker-compose up -d

# 4. è¿è¡Œæ•°æ®åº“è¿ç§»
docker-compose exec backend alembic upgrade head

# 5. åˆ›å»ºè¶…çº§ç”¨æˆ·
docker-compose exec backend python scripts/create_superuser.py

# 6. è®¿é—®åº”ç”¨
# å‰ç«¯: http://localhost:3000
# åç«¯: http://localhost:8000
# API æ–‡æ¡£: http://localhost:8000/docs
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½² (Kubernetes)

```yaml
# deployment.yaml ç¤ºä¾‹
apiVersion: apps/v1
kind: Deployment
metadata:
  name: docxtpl-backend
  namespace: docxtpl
spec:
  replicas: 3
  selector:
    matchLabels:
      app: docxtpl-backend
  template:
    metadata:
      labels:
        app: docxtpl-backend
    spec:
      containers:
      - name: backend
        image: docxtpl/backend:latest
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: docxtpl-secrets
              key: database-url
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: docxtpl-secrets
              key: redis-url
        - name: S3_ACCESS_KEY
          valueFrom:
            secretKeyRef:
              name: docxtpl-secrets
              key: s3-access-key
        resources:
          requests:
            memory: "256Mi"
            cpu: "250m"
          limits:
            memory: "512Mi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /health
            port: 8000
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /ready
            port: 8000
          initialDelaySeconds: 5
          periodSeconds: 5
```

### CI/CD æµç¨‹ (GitHub Actions)

```yaml
# .github/workflows/ci-cd.yml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'

    - name: Install dependencies
      run: |
        pip install -r backend/requirements.txt
        pip install -r backend/requirements-dev.txt

    - name: Run tests
      run: |
        cd backend
        pytest tests/ --cov=app --cov-report=xml

    - name: Upload coverage
      uses: codecov/codecov-action@v3
      with:
        file: ./backend/coverage.xml

  build-and-push:
    needs: test
    if: github.ref == 'refs/heads/main'
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3

    - name: Set up Docker Buildx
      uses: docker/setup-buildx-action@v2

    - name: Login to DockerHub
      uses: docker/login-action@v2
      with:
        username: ${{ secrets.DOCKER_USERNAME }}
        password: ${{ secrets.DOCKER_PASSWORD }}

    - name: Build and push backend
      uses: docker/build-push-action@v4
      with:
        context: ./backend
        push: true
        tags: docxtpl/backend:latest

    - name: Build and push frontend
      uses: docker/build-push-action@v4
      with:
        context: ./frontend
        push: true
        tags: docxtpl/frontend:latest

  deploy:
    needs: build-and-push
    if: github.ref == 'refs/heads/main'
    runs-on: ubuntu-latest
    steps:
    - name: Deploy to Kubernetes
      uses: azure/k8s-deploy@v4
      with:
        manifests: |
          kubernetes/deployment.yaml
          kubernetes/service.yaml
        images: |
          docxtpl/backend:latest
          docxtpl/frontend:latest
```

## ğŸ“ˆ ç›‘æ§å’Œè¿ç»´

### ç›‘æ§æŒ‡æ ‡

```yaml
# prometheus-rules.yaml
groups:
  - name: docxtpl_alerts
    rules:
    - alert: HighErrorRate
      expr: rate(http_requests_total{status=~"5.."}[5m]) > 0.05
      for: 5m
      annotations:
        summary: "High error rate detected"
        description: "Error rate is above 5% for 5 minutes"

    - alert: HighResponseTime
      expr: http_request_duration_seconds{quantile="0.99"} > 2
      for: 5m
      annotations:
        summary: "High response time"
        description: "99th percentile response time is above 2s"

    - alert: LowDiskSpace
      expr: node_filesystem_avail_bytes / node_filesystem_size_bytes < 0.1
      for: 5m
      annotations:
        summary: "Low disk space"
        description: "Less than 10% disk space remaining"
```

### æ—¥å¿—ç®¡ç†

```python
# backend/app/core/logging.py
import logging
from pythonjsonlogger import jsonlogger

def setup_logging():
    logHandler = logging.StreamHandler()
    formatter = jsonlogger.JsonFormatter(
        fmt='%(asctime)s %(levelname)s %(name)s %(message)s',
        datefmt='%Y-%m-%d %H:%M:%S'
    )
    logHandler.setFormatter(formatter)

    logger = logging.getLogger()
    logger.addHandler(logHandler)
    logger.setLevel(logging.INFO)

    # æ·»åŠ è¯·æ±‚ ID åˆ°æ—¥å¿—
    import contextvars
    request_id = contextvars.ContextVar('request_id', default=None)

    class RequestIdFilter(logging.Filter):
        def filter(self, record):
            record.request_id = request_id.get()
            return True

    logger.addFilter(RequestIdFilter())
```

## ğŸ”’ å®‰å…¨æªæ–½

### å®‰å…¨æ¸…å•

- [x] **è®¤è¯å’Œæˆæƒ**
  - JWT token è®¤è¯
  - OAuth2.0 æ”¯æŒ (Google, GitHub)
  - åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ (RBAC)
  - API å¯†é’¥ç®¡ç†

- [x] **æ•°æ®ä¿æŠ¤**
  - å¯†ç ä½¿ç”¨ bcrypt å“ˆå¸Œ
  - æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨
  - HTTPS å¼ºåˆ¶ä½¿ç”¨
  - SQL æ³¨å…¥é˜²æŠ¤ (ä½¿ç”¨ ORM)

- [x] **æ–‡ä»¶å®‰å…¨**
  - æ–‡ä»¶ç±»å‹éªŒè¯
  - æ–‡ä»¶å¤§å°é™åˆ¶
  - ç—…æ¯’æ‰«æé›†æˆ
  - å®‰å…¨çš„æ–‡ä»¶å­˜å‚¨è·¯å¾„

- [x] **API å®‰å…¨**
  - é€Ÿç‡é™åˆ¶
  - CORS é…ç½®
  - è¯·æ±‚å¤§å°é™åˆ¶
  - API ç‰ˆæœ¬æ§åˆ¶

- [x] **ç›‘æ§å’Œå®¡è®¡**
  - è®¿é—®æ—¥å¿—è®°å½•
  - å¼‚å¸¸ç›‘æ§ (Sentry)
  - å®‰å…¨äº‹ä»¶å‘Šè­¦
  - å®šæœŸå®‰å…¨å®¡è®¡

## ğŸ’° å•†ä¸šæ¨¡å¼

### è®¢é˜…è®¡åˆ’

| ç‰¹æ€§ | å…è´¹ç‰ˆ | åŸºç¡€ç‰ˆ | ä¸“ä¸šç‰ˆ | ä¼ä¸šç‰ˆ |
|------|--------|--------|--------|--------|
| ä»·æ ¼/æœˆ | $0 | $9.99 | $29.99 | è”ç³»é”€å”® |
| æ–‡æ¡£ç”Ÿæˆ/æœˆ | 10 | 100 | 1000 | æ— é™ |
| æ¨¡æ¿æ•°é‡ | 3 | 20 | 100 | æ— é™ |
| å­˜å‚¨ç©ºé—´ | 100MB | 1GB | 10GB | è‡ªå®šä¹‰ |
| API è®¿é—® | âŒ | âœ… | âœ… | âœ… |
| è‡ªå®šä¹‰åŸŸå | âŒ | âŒ | âœ… | âœ… |
| ä¼˜å…ˆæ”¯æŒ | âŒ | Email | Email + Chat | 24/7 ä¸“å± |
| æ¨¡æ¿å¸‚åœºæ”¶å…¥ | 70% | 80% | 90% | 95% |

### æ”¶å…¥æ¥æº

1. **è®¢é˜…æ”¶å…¥** - æœˆåº¦/å¹´åº¦è®¢é˜…
2. **äº¤æ˜“ä½£é‡‘** - æ¨¡æ¿å¸‚åœºäº¤æ˜“æŠ½æˆ (5-30%)
3. **API ä½¿ç”¨è´¹** - æŒ‰ä½¿ç”¨é‡è®¡è´¹
4. **ä¼ä¸šå®šåˆ¶** - ç§æœ‰åŒ–éƒ¨ç½²å’Œå®šåˆ¶å¼€å‘
5. **å¢å€¼æœåŠ¡** - æ¨¡æ¿å®šåˆ¶ã€åŸ¹è®­ã€å’¨è¯¢

## ğŸ“Š å…³é”®æ€§èƒ½æŒ‡æ ‡ (KPIs)

### æŠ€æœ¯æŒ‡æ ‡
- API å“åº”æ—¶é—´ < 200ms (p95)
- æ–‡æ¡£ç”Ÿæˆæ—¶é—´ < 5ç§’ (æ™®é€šæ–‡æ¡£)
- ç³»ç»Ÿå¯ç”¨æ€§ > 99.9%
- å¹¶å‘ç”¨æˆ·æ”¯æŒ > 10,000

### ä¸šåŠ¡æŒ‡æ ‡
- æœˆæ´»è·ƒç”¨æˆ· (MAU)
- ä»˜è´¹è½¬åŒ–ç‡
- å®¢æˆ·è·å–æˆæœ¬ (CAC)
- ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼ (LTV)
- æœˆåº¦ç»å¸¸æ€§æ”¶å…¥ (MRR)

## ğŸ—ºï¸ å¼€å‘è·¯çº¿å›¾

### ç¬¬ä¸€é˜¶æ®µ (MVP) - 3ä¸ªæœˆ
- [x] åŸºç¡€ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- [x] æ¨¡æ¿ä¸Šä¼ å’Œç®¡ç†
- [x] æ–‡æ¡£ç”Ÿæˆ API
- [x] ç®€å•çš„ Web ç•Œé¢
- [ ] åŸºç¡€è®¡è´¹ç³»ç»Ÿ

### ç¬¬äºŒé˜¶æ®µ (å¢å¼º) - 2ä¸ªæœˆ
- [ ] æ¨¡æ¿å¸‚åœºåŠŸèƒ½
- [ ] é«˜çº§æ¨¡æ¿ç¼–è¾‘å™¨
- [ ] æ‰¹é‡æ–‡æ¡£ç”Ÿæˆ
- [ ] API æ–‡æ¡£å’Œ SDK
- [ ] å¤šè¯­è¨€æ”¯æŒ

### ç¬¬ä¸‰é˜¶æ®µ (æ‰©å±•) - 2ä¸ªæœˆ
- [ ] AI è¾…åŠ©æ¨¡æ¿åˆ›å»º
- [ ] å›¢é˜Ÿåä½œåŠŸèƒ½
- [ ] é«˜çº§åˆ†æä»ªè¡¨æ¿
- [ ] Webhook é›†æˆ
- [ ] ç§»åŠ¨åº”ç”¨

### ç¬¬å››é˜¶æ®µ (ä¼˜åŒ–) - æŒç»­
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] å®‰å…¨åŠ å›º
- [ ] ç”¨æˆ·ä½“éªŒæ”¹è¿›
- [ ] æ–°åŠŸèƒ½è¿­ä»£

## ğŸš¦ å¿«é€Ÿå¼€å§‹æŒ‡å—

### åç«¯å¼€å‘

```bash
# 1. è®¾ç½® Python è™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 2. å®‰è£…ä¾èµ–
cd backend
pip install -r requirements.txt
pip install -r requirements-dev.txt

# 3. è®¾ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“ç­‰

# 4. è¿è¡Œæ•°æ®åº“è¿ç§»
alembic upgrade head

# 5. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
uvicorn app.main:app --reload --port 8000

# 6. è¿è¡Œæµ‹è¯•
pytest tests/
```

### å‰ç«¯å¼€å‘

```bash
# 1. å®‰è£…ä¾èµ–
cd frontend
npm install

# 2. è®¾ç½®ç¯å¢ƒå˜é‡
cp .env.example .env.local
# ç¼–è¾‘ .env.localï¼Œé…ç½® API ç«¯ç‚¹ç­‰

# 3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# 4. æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# 5. è¿è¡Œæµ‹è¯•
npm test
```

### Docker å¼€å‘ç¯å¢ƒ

```bash
# æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up --build

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f backend
docker-compose logs -f frontend

# è¿›å…¥å®¹å™¨
docker-compose exec backend bash
docker-compose exec frontend sh

# æ¸…ç†ç¯å¢ƒ
docker-compose down -v
```

## ğŸ“ ä»£ç ç¤ºä¾‹

### åç«¯ API ç¤ºä¾‹

```python
# backend/app/api/v1/templates.py
from fastapi import APIRouter, Depends, HTTPException, UploadFile, File
from sqlalchemy.orm import Session
from typing import List

from app.core.database import get_db
from app.core.security import get_current_user
from app.models.template import Template
from app.schemas.template import TemplateCreate, TemplateResponse
from app.services.template_service import TemplateService

router = APIRouter(prefix="/templates", tags=["templates"])

@router.post("/", response_model=TemplateResponse)
async def create_template(
    *,
    db: Session = Depends(get_db),
    current_user = Depends(get_current_user),
    file: UploadFile = File(...),
    name: str,
    description: str = None,
    category: str = None,
    is_public: bool = False
):
    """
    åˆ›å»ºæ–°æ¨¡æ¿
    """
    service = TemplateService(db)

    # éªŒè¯æ–‡ä»¶ç±»å‹
    if not file.filename.endswith('.docx'):
        raise HTTPException(
            status_code=400,
            detail="Only .docx files are allowed"
        )

    # åˆ›å»ºæ¨¡æ¿
    template = await service.create_template(
        user_id=current_user.id,
        file=file,
        name=name,
        description=description,
        category=category,
        is_public=is_public
    )

    return template

@router.get("/", response_model=List[TemplateResponse])
async def list_templates(
    *,
    db: Session = Depends(get_db),
    current_user = Depends(get_current_user),
    skip: int = 0,
    limit: int = 20,
    category: str = None,
    is_public: bool = None
):
    """
    è·å–æ¨¡æ¿åˆ—è¡¨
    """
    service = TemplateService(db)
    templates = await service.list_templates(
        user_id=current_user.id,
        skip=skip,
        limit=limit,
        category=category,
        is_public=is_public
    )
    return templates

@router.post("/{template_id}/generate", response_model=DocumentResponse)
async def generate_document(
    *,
    db: Session = Depends(get_db),
    current_user = Depends(get_current_user),
    template_id: str,
    data: dict
):
    """
    ä½¿ç”¨æ¨¡æ¿ç”Ÿæˆæ–‡æ¡£
    """
    service = TemplateService(db)

    # æ£€æŸ¥æƒé™
    template = await service.get_template(template_id)
    if not template:
        raise HTTPException(status_code=404, detail="Template not found")

    if template.user_id != current_user.id and not template.is_public:
        raise HTTPException(status_code=403, detail="Access denied")

    # ç”Ÿæˆæ–‡æ¡£
    document = await service.generate_document(
        template_id=template_id,
        user_id=current_user.id,
        data=data
    )

    return document
```

### å‰ç«¯ç»„ä»¶ç¤ºä¾‹

```tsx
// frontend/src/pages/Templates/TemplateList.tsx
import React, { useState, useEffect } from 'react';
import { Card, Button, Table, Space, Modal, message } from 'antd';
import { PlusOutlined, EditOutlined, DeleteOutlined } from '@ant-design/icons';
import { useNavigate } from 'react-router-dom';
import { useQuery, useMutation } from 'react-query';

import { templateApi } from '@/services/api';
import { Template } from '@/types';

const TemplateList: React.FC = () => {
  const navigate = useNavigate();
  const [selectedTemplate, setSelectedTemplate] = useState<Template | null>(null);

  // è·å–æ¨¡æ¿åˆ—è¡¨
  const { data: templates, isLoading, refetch } = useQuery(
    'templates',
    () => templateApi.list(),
    {
      onError: (error) => {
        message.error('Failed to load templates');
      }
    }
  );

  // åˆ é™¤æ¨¡æ¿
  const deleteMutation = useMutation(
    (id: string) => templateApi.delete(id),
    {
      onSuccess: () => {
        message.success('Template deleted successfully');
        refetch();
      },
      onError: () => {
        message.error('Failed to delete template');
      }
    }
  );

  const columns = [
    {
      title: 'Name',
      dataIndex: 'name',
      key: 'name',
    },
    {
      title: 'Category',
      dataIndex: 'category',
      key: 'category',
    },
    {
      title: 'Created',
      dataIndex: 'created_at',
      key: 'created_at',
      render: (date: string) => new Date(date).toLocaleDateString(),
    },
    {
      title: 'Public',
      dataIndex: 'is_public',
      key: 'is_public',
      render: (isPublic: boolean) => (isPublic ? 'Yes' : 'No'),
    },
    {
      title: 'Actions',
      key: 'actions',
      render: (_, record: Template) => (
        <Space>
          <Button
            icon={<EditOutlined />}
            onClick={() => navigate(`/templates/${record.id}/edit`)}
          >
            Edit
          </Button>
          <Button
            danger
            icon={<DeleteOutlined />}
            onClick={() => handleDelete(record.id)}
          >
            Delete
          </Button>
        </Space>
      ),
    },
  ];

  const handleDelete = (id: string) => {
    Modal.confirm({
      title: 'Delete Template',
      content: 'Are you sure you want to delete this template?',
      onOk: () => deleteMutation.mutate(id),
    });
  };

  return (
    <Card
      title="My Templates"
      extra={
        <Button
          type="primary"
          icon={<PlusOutlined />}
          onClick={() => navigate('/templates/new')}
        >
          New Template
        </Button>
      }
    >
      <Table
        columns={columns}
        dataSource={templates}
        loading={isLoading}
        rowKey="id"
      />
    </Card>
  );
};

export default TemplateList;
```

### MCP æ¡¥æ¥ä»£ç ç¤ºä¾‹

```python
# backend/app/mcp_bridge/server.py
import asyncio
from typing import Dict, Any, List
from mcp.server import Server
import mcp.types as types

from app.services.template_service import TemplateService
from app.services.document_service import DocumentService

class MCPBridge:
    """
    MCP åè®®æ¡¥æ¥å™¨ï¼Œå°† MCP è¯·æ±‚è½¬æ¢ä¸º API è°ƒç”¨
    """

    def __init__(self, api_key: str):
        self.api_key = api_key
        self.server = Server("docxtpl-online")
        self.template_service = TemplateService()
        self.document_service = DocumentService()
        self.setup_handlers()

    def setup_handlers(self):
        @self.server.list_tools()
        async def list_tools() -> List[types.Tool]:
            return [
                types.Tool(
                    name="generate_document",
                    description="Generate document from template",
                    inputSchema={
                        "type": "object",
                        "properties": {
                            "template_id": {
                                "type": "string",
                                "description": "Template ID"
                            },
                            "data": {
                                "type": "object",
                                "description": "Template data"
                            }
                        },
                        "required": ["template_id", "data"]
                    }
                ),
                types.Tool(
                    name="list_templates",
                    description="List available templates",
                    inputSchema={
                        "type": "object",
                        "properties": {
                            "category": {
                                "type": "string",
                                "description": "Filter by category"
                            }
                        }
                    }
                )
            ]

        @self.server.call_tool()
        async def call_tool(
            name: str,
            arguments: Dict[str, Any]
        ) -> List[types.TextContent]:
            # éªŒè¯ API å¯†é’¥
            user = await self.authenticate(self.api_key)
            if not user:
                return [types.TextContent(
                    type="text",
                    text="Authentication failed"
                )]

            if name == "generate_document":
                result = await self.document_service.generate(
                    user_id=user.id,
                    template_id=arguments["template_id"],
                    data=arguments["data"]
                )
                return [types.TextContent(
                    type="text",
                    text=f"Document generated: {result['document_id']}"
                )]

            elif name == "list_templates":
                templates = await self.template_service.list(
                    user_id=user.id,
                    category=arguments.get("category")
                )
                return [types.TextContent(
                    type="text",
                    text=f"Found {len(templates)} templates"
                )]

    async def authenticate(self, api_key: str):
        # éªŒè¯ API å¯†é’¥å¹¶è¿”å›ç”¨æˆ·
        # å®ç°çœç•¥
        pass

    async def run(self):
        # å¯åŠ¨ MCP æœåŠ¡å™¨
        await self.server.run()
```

## ğŸ¤ å›¢é˜Ÿå’Œè´¡çŒ®

### æ ¸å¿ƒå›¢é˜Ÿè§’è‰²
- **é¡¹ç›®è´Ÿè´£äºº** - æ•´ä½“æ¶æ„å’Œäº§å“æ–¹å‘
- **åç«¯å¼€å‘** - API å’Œä¸šåŠ¡é€»è¾‘å¼€å‘
- **å‰ç«¯å¼€å‘** - UI/UX å®ç°
- **DevOps** - éƒ¨ç½²å’Œè¿ç»´
- **QA** - æµ‹è¯•å’Œè´¨é‡ä¿è¯

### è´¡çŒ®æŒ‡å—
1. Fork é¡¹ç›®ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤ä»£ç å¹¶ç¼–å†™æµ‹è¯•
4. åˆ›å»º Pull Request
5. ä»£ç å®¡æŸ¥å’Œåˆå¹¶

## ğŸ“š å‚è€ƒèµ„æº

- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [React Documentation](https://react.dev/)
- [PostgreSQL Documentation](https://www.postgresql.org/docs/)
- [Docker Documentation](https://docs.docker.com/)
- [Kubernetes Documentation](https://kubernetes.io/docs/)
- [MCP Protocol Specification](https://modelcontextprotocol.io/)

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ï¼Œè¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„æŠ€æœ¯æ¶æ„æ–‡æ¡£ï¼Œå¯ä»¥ä½œä¸ºæ–°é¡¹ç›®çš„å¼€å‘æŒ‡å—ã€‚è¯·æ ¹æ®å®é™…éœ€æ±‚è¿›è¡Œè°ƒæ•´å’Œä¼˜åŒ–ã€‚

å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦è¿›ä¸€æ­¥çš„æŠ€æœ¯ç»†èŠ‚ï¼Œè¯·éšæ—¶è¯¢é—®ï¼